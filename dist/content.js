(()=>{console.log("✅ Content Script Loaded");let e=!1;function t(){const t=document.querySelector("#secondary-inner"),r=document.querySelector(".yt-summary-container");if(t&&!r){const r=document.createElement("div");r.className="yt-summary-container",r.innerHTML='\n            <div class="yt-summary-header">\n                <span class="yt-summary-title">✨ AI Summary</span>\n                <button id="yt-gen-btn" class="yt-summary-btn">Summarize</button>\n            </div>\n            <div id="yt-loading" class="yt-loader"></div>\n            <div id="yt-summary-text" class="yt-summary-content"></div>\n        ',t.insertBefore(r,t.firstChild),e=!0,document.getElementById("yt-gen-btn").addEventListener("click",n)}}async function n(){const e=document.getElementById("yt-gen-btn"),t=document.getElementById("yt-loading"),n=document.getElementById("yt-summary-text");e.disabled=!0,e.innerText="Thinking...",t.style.display="block",n.innerText="";const s=window.location.href;try{const e=await r({action:"fetchTranscript",url:s});if("error"===e.status)throw new Error(e.message);n.innerText="Reading transcript... (This might take a moment)";const t=await r({action:"summarize",text:e.transcript});if("error"===t.status)throw new Error(t.message);n.innerText=t.summary}catch(e){n.innerText="❌ Error: "+e.message}finally{e.disabled=!1,e.innerText="Summarize",t.style.display="none"}}function r(e){return new Promise(t=>{chrome.runtime.sendMessage(e,e=>{t(e)})})}new MutationObserver(()=>{t()}).observe(document.body,{childList:!0,subtree:!0}),t()})();