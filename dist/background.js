chrome.runtime.onMessage.addListener((t,e,s)=>"fetchTranscript"===t.action?(console.log("üì• Fetching transcript for:",t.url),function(t,e){fetch("http://127.0.0.1:5000/get_transcript",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:t})}).then(t=>t.json()).then(t=>{"success"===t.status?e({status:"success",transcript:t.transcript}):e({status:"error",message:t.message})}).catch(t=>{e({status:"error",message:"Is the Python Server running? "+t.message})})}(t.url,s),!0):"summarize"===t.action?(console.log("üß† Starting AI Summarization via Python server..."),async function(t){let e=[];for(let s=0;s<t.length;s+=2500)e.push(t.slice(s,s+2500));console.log(`üß© Split text into ${e.length} chunks.`);let s=[];for(let t=0;t<e.length;t++){let r=e[t];console.log(`   -> Processing Chunk ${t+1}/${e.length}...`);try{const e=await fetch("http://127.0.0.1:5000/summarize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:r})}),n=await e.json();if("error"===n.status)throw new Error(n.message);let o=n.summary.trim();s.push(o),console.log(`   ‚úÖ Chunk ${t+1} summarized (${o.length} chars)`)}catch(e){throw console.warn(`‚ö†Ô∏è Error on chunk ${t}:`,e),new Error(`Failed to summarize chunk ${t+1}: ${e.message}`)}}return s.join("\n\n")}(t.text).then(t=>{console.log("‚úÖ Summary Complete"),s({status:"success",summary:t})}).catch(t=>{console.error("‚ùå Summarization Error:",t),s({status:"error",message:"Is the Python model server running? "+t.message})}),!0):void 0);